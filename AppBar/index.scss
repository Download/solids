//
// Copyright 2018 Stijn de Witt. Some rights reserved.
// Licensed under the MIT Open Source license. 
// https://opensource.org/licenses/MIT
// See LICENSE for details.
//
// Based on code copyright 2018 Google Inc. All Rights Reserved.
// Licensed under the Apache License, Version 2.0.
// http://www.apache.org/licenses/LICENSE-2.0
// See LICENSE-MDC for details.
// 
// Unless required by applicable law or agreed to in writing, software
// distributed under these licenses is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the licenses for the specific language governing permissions and
// limitations under these licenses.
// 

@import "../rtl/mixins";
@import "../elevation/mixins";
@import "../animation/variables";
@import "../typography/mixins";
@import "./mixins";
@import "./variables";

// postcss-bem-linter: define top-app-bar
.solid_appbar {
  @include appbar-fill-color-accessible(primary);
  @include appbar-icon-ink-color(on-primary);

  display: flex;
  flex-direction: column;
  justify-content: space-between;
  box-sizing: border-box;
  width: 100%;
  margin-bottom: 16px;
  z-index: 1;

  >div {
    display: flex;
    position: relative;
    box-sizing: border-box;
    width: 100%;

    >section {
      display: inline-flex;
      flex: 1 1 auto;
      align-items: center;
      min-width: 0;
      padding: $appbar-section-vertical-padding $appbar-section-horizontal-padding;
      z-index: 1;
  
      &.appbar_start {
        justify-content: flex-start;
        order: -1;

        &.appbar_reserve {
          @include mdc-rtl-reflexive-box(margin, left, 48px);
        }
      }
  
      &.appbar_end {
        justify-content: flex-end;
        order: 1;
        &.appbar_reserve {
          @include mdc-rtl-reflexive-box(margin, right, 48px);
        }
      }

      .appbar_title {
        @include typography(headline6);
        @include mdc-rtl-reflexive-box(padding, left, $appbar-title-left-padding);
        text-overflow: ellipsis;
        white-space: nowrap;
        overflow: hidden;
        z-index: 1;
      }
    }
  }

  .appbar_action,
  .appbar_icon {
    @include appbar-icon_;
  }

  &.appbar_floating {
    @include mdc-elevation(4);
  }
  

  &.appbar_short {
    position: fixed;
    top: 0;
    right: auto;
    left: 0;
    width: 100%;
    transition: width 250ms $mdc-animation-standard-curve-timing-function;

    @include mdc-rtl {
      right: 0;
      left: auto;
    }

    >div {
      height: $appbar-mobile-row-height;

      >section {
        padding: $appbar-mobile-section-padding;

        .appbar_title {
          transition: opacity 200ms $mdc-animation-standard-curve-timing-function;
          opacity: 1;
        }
      }
    }
  }

  &.appbar_short_collapsed {
    @include appbar-short-border-radius;
    @include mdc-elevation(4);
  
    width: $appbar-short-collapsed-width;
    transition: width 300ms $mdc-animation-standard-curve-timing-function;
  
    >div >section .appbar_title {
      opacity: 0;
    }
  
    .appbar_action {
      transition: padding 150ms $mdc-animation-standard-curve-timing-function;
    }

    &.appbar_short_has_action {
      width: $appbar-short-collapsed-width * 2;

      >div >section.appbar_end {
        @include mdc-rtl-reflexive-box(padding, right, 12px);
      }
    }
  }

  // stylelint-disable-next-line plugin/selector-bem-pattern
  &.appbar_dense {
    >div {
      height: $appbar-dense-row-height;

      >section {
        padding: 0 $appbar-dense-section-horizontal-padding;

        .appbar_title {
          @include mdc-rtl-reflexive-box(padding, left, $appbar-dense-title-left-padding);
        }
      }
    }
  }

  &.appbar_prominent {
    >div {
      height: $appbar-prominent-row-height;

      >section {
        align-items: flex-end;

        .appbar_action,
        .appbar_icon {
          align-self: flex-start;
        }
      }
    }
  }

  // Specific styles for prominent and dense styled top app bar
  // stylelint-disable plugin/selector-bem-pattern
  &.appbar_dense.appbar_prominent {

    >div {
      height: $appbar-dense-row-height * 2;

      >section {
        padding: 8px $appbar-section-horizontal-padding;

        &.appbar_end {
          height: $appbar-dense-row-height + 8px;
        }

        .appbar_title {
          @include mdc-rtl-reflexive-box(padding, left, $appbar-title-left-padding);
        }

        .appbar_action,
        .appbar_icon {
          align-self: auto;
        }
      }
    }
  }
  // stylelint-enable plugin/selector-bem-pattern

  // stylelint-disable-next-line plugin/selector-bem-pattern
  &.appbar_fixed {
    position: sticky;
    top: -16px;
    margin-bottom: 0px;
    height: $appbar-row-height + 16px;
    background: transparent;

    >div {
      @include appbar-fill-color-accessible(primary);
      // height: $appbar-row-height;
      position: sticky;
      top: 0px;
      margin-top: -16px;
      z-index: 3;

      >section {
        position: sticky;

        &.appbar_start {
          top: 0;
        }

        &.appbar_end {
          top: 0;
        }
      }
    }

    &:before,
    &:after {
      content: '';
      display: block;
      height: 16px;
      width: 100%;
      position: sticky;
    }

    &:before {
      @include mdc-elevation(4);
      top: $appbar-row-height - 16px;
    }

    &:after {
      background: linear-gradient(rgba($mdc-theme-background,1), rgba($mdc-theme-background,.25));
      z-index: 2;
      top: 0;
    }

    &.appbar_dense {
      height: $appbar-dense-row-height;

      &:before {
        top: $appbar-dense-row-height;
      }
    }  

    &.appbar_prominent {
      height: $appbar-prominent-row-height + 16px;
      top: -16px;

      &:before {
        top: $appbar-prominent-row-height - 16px;
      }
    }

    &.appbar_dense.appbar_prominent {
      height: $appbar-dense-row-height*2 + 16px;

      &:before {
        top: $appbar-dense-row-height*2 - 16px;
      }
    }

    &.appbar_shrink {
      &.appbar_prominent {
        height: $appbar-prominent-row-height;
        top: -($appbar-prominent-row-height - $appbar-row-height);
        margin-bottom: 16px;
        
        >div {
          >section {
            align-items: center;
            height: $appbar-row-height;
            position: sticky;
            &.appbar_start {
              top: $appbar-row-height;
            }
            &.appbar_end {
              top: 0;
            }
          }
        }

        &:before {
          top: $appbar-row-height - 16px;
        }
      
        &:after {
          top: 0;
          display: none;
        }    
      }

      &.appbar_dense.appbar_prominent {
        height: $appbar-dense-row-height*2;
        top: -($appbar-dense-row-height*2 - $appbar-dense-row-height);

        >div {
          >section {
            height: $appbar-dense-row-height;
            &.appbar_start {
              top: $appbar-dense-row-height;
            }
          }
        }

        &:before {
          top: $appbar-dense-row-height - 16px;
        }
      }
    }

    &.appbar_floating {
      box-shadow: none;
      
      >div {
        @include mdc-elevation(4);
      }
  
      &:before {
        display: none;
      }
  
      &:after {
        display: none;
      }
    }
  }
}

// Mobile Styles
@include appbar-mobile-breakpoint_;
